<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Deposit Cash</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div id="info-bar" class="poppins-semibold">
            <div class="date">
              <span id="date"></span>
            </div>
            <div class="time">
              <span id="time"></span>
            </div>
            <div class="weather">
              <span id="weather"></span>
            </div>
        </div>
        <script src="datetime-weather.js"></script>
        <div class="header">
            <h1 class="title">Deposit Cash</h1>
        </div>
        
        <div class="amount-container">
            <p class="amount-label">Enter the amount you want to deposit</p>
            <div class="amount-input-container">
                <span class="currency-symbol">KWD</span>
                <input type="text" class="amount-input" id="amountInput" placeholder="0">
            </div>
            <p class="amount-words" id="amountInWords">Zero Only</p>
        </div>

        <button class="withdraw-btn" id="withdrawBtn">DEPOSIT</button>
        <span class="exit-arrow" onclick="window.location.href='menu.html'">EXIT</span>
    </div>
    <script src="script.js"></script>
    <script>
        const amountInput = document.getElementById('amountInput');
        const amountInWords = document.getElementById('amountInWords');
        const withdrawBtn = document.getElementById('withdrawBtn');

        function numberToWords(num) {
            const ones = ['', 'One', 'Two', 'Three', 'Four', 'Five', 'Six', 'Seven', 'Eight', 'Nine'];
            const tens = ['', '', 'Twenty', 'Thirty', 'Forty', 'Fifty', 'Sixty', 'Seventy', 'Eighty', 'Ninety'];
            const teens = ['Ten', 'Eleven', 'Twelve', 'Thirteen', 'Fourteen', 'Fifteen', 'Sixteen', 'Seventeen', 'Eighteen', 'Nineteen'];

            if (num === 0) return 'Zero Only';

            function convertLessThanThousand(n) {
                if (n === 0) return '';

                let result = '';

                if (n >= 100) {
                    result += ones[Math.floor(n / 100)] + ' Hundred ';
                    n %= 100;
                }

                if (n >= 20) {
                    result += tens[Math.floor(n / 10)] + ' ';
                    n %= 10;
                } else if (n >= 10) {
                    result += teens[n - 10] + ' ';
                    return result;
                }

                if (n > 0) {
                    result += ones[n] + ' ';
                }

                return result;
            }

            let result = '';
            let n = parseInt(num);

            if (n >= 1000) {
                result += convertLessThanThousand(Math.floor(n / 1000)) + 'Thousand ';
                n %= 1000;
            }

            result += convertLessThanThousand(n);

            return result.trim() + ' Only';
        }

        amountInput.addEventListener('input', (e) => {
            // Remove any non-digit characters
            let value = e.target.value.replace(/\D/g, '');
            
            // Limit to 6 digits
            if (value.length > 6) {
                value = value.slice(0, 6);
            }
            
            // Update input value
            e.target.value = value;
            
            // Update amount in words
            amountInWords.textContent = value ? numberToWords(value) : 'Zero Only';
            
            // Enable/disable withdraw button
            withdrawBtn.disabled = !value;
        });

        withdrawBtn.addEventListener('click', () => {
            if (!amountInput.value) return;

            const currentUser = JSON.parse(localStorage.getItem("currentUser"));
            const depositAmount = parseInt(amountInput.value);

            withdrawBtn.textContent = 'Processing...';
            withdrawBtn.disabled = true;

            // Simulate transaction processing
            setTimeout(() => {
                // Update the balance of the current user
                const userIndex = accounts.findIndex(acc => acc.pin === currentUser.pin);
                accounts[userIndex].balance += depositAmount;
                localStorage.setItem("accounts", JSON.stringify(accounts));
                localStorage.setItem("currentUser", JSON.stringify(accounts[userIndex]));
                window.location.href = "exit.html?message=deposit-success";
            }, 2000);
        });
    </script>
</body>
</html>